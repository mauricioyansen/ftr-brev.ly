# Brev.ly - Encurtador de Links Full-Stack

![React](https://img.shields.io/badge/React-20232A?style=for-the-badge&logo=react&logoColor=61DAFB)
![NestJS](https://img.shields.io/badge/NestJS-E0234E?style=for-the-badge&logo=nestjs&logoColor=white)
![Fastify](https://img.shields.io/badge/Fastify-000000?style=for-the-badge&logo=fastify&logoColor=white)
![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?style=for-the-badge&logo=typescript&logoColor=white)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white)
![TailwindCSS](https://img.shields.io/badge/Tailwind_CSS-38B2AC?style=for-the-badge&logo=tailwind-css&logoColor=white)

Brev.ly √© uma aplica√ß√£o full-stack completa de encurtamento de links, constru√≠da com um backend robusto em NestJS com Fastify e um frontend reativo e moderno em React (Vite).

## üìñ Sobre o Projeto

Este projeto foi desenvolvido como uma solu√ß√£o completa para o gerenciamento de URLs, permitindo aos usu√°rios transformar links longos e complexos em URLs curtas, f√°ceis de partilhar e memorizar. Al√©m da funcionalidade b√°sica de encurtamento, a plataforma oferece recursos avan√ßados como a personaliza√ß√£o de links (vanity URLs), o rastreamento do n√∫mero de acessos e a exporta√ß√£o de relat√≥rios em CSV para uma CDN.

A arquitetura foi pensada para ser escal√°vel, segura e de alta performance, utilizando tecnologias modernas e as melhores pr√°ticas de desenvolvimento, incluindo um ambiente de desenvolvimento containerizado com Docker e uma su√≠te de testes completa (E2E e Unit√°rios).

## ‚ú® Funcionalidades

### Backend (API - `server/`)
- ‚úÖ **Cria√ß√£o de Links:** Suporte para c√≥digos curtos aleat√≥rios (`nanoid`) ou customizados.
- ‚úÖ **Valida√ß√£o Robusta:** Utiliza√ß√£o do Zod para garantir a integridade dos dados de entrada.
- ‚úÖ **Redirecionamento:** Endpoint p√∫blico de alta performance para redirecionamento.
- ‚úÖ **Contagem de Acessos:** Incremento at√≥mico do contador de acessos a cada redirecionamento.
- ‚úÖ **Gest√£o de Links:** Endpoints para listar e deletar links.
- ‚úÖ **Exporta√ß√£o para CSV:** Gera√ß√£o de relat√≥rios em CSV e upload autom√°tico para uma CDN (Cloudflare R2).
- ‚úÖ **Banco de Dados Moderno:** Integra√ß√£o com PostgreSQL atrav√©s do Drizzle ORM, com um fluxo de migra√ß√µes.
- ‚úÖ **Testes Automatizados:** Su√≠te de testes completa com testes End-to-End (Jest + Supertest) e Unit√°rios (Jest).

### Frontend (Dashboard - `web/`)
- ‚úÖ **Interface Reativa:** Single-Page Application (SPA) constru√≠da com React e Vite.
- ‚úÖ **Cria√ß√£o e Gest√£o:** Formul√°rio interativo para criar e listar links em tempo real.
- ‚úÖ **Experi√™ncia do Utilizador (UX):**
    - Atualiza√ß√µes otimistas para uma sensa√ß√£o de resposta instant√¢nea.
    - Estados de carregamento (`loading`), erro e vazio (`empty state`).
    - Feedback ao utilizador atrav√©s de toasts (`sonner`).
    - Valida√ß√£o de formul√°rios no lado do cliente com React Hook Form e Zod.
- ‚úÖ **Layout Responsivo:** Interface adapt√°vel para desktops e dispositivos m√≥veis.
- ‚úÖ **P√°gina Intermedi√°ria de Redirecionamento:** Efeito visual para o fluxo de redirecionamento.
- ‚úÖ **Download de Relat√≥rios:** Bot√£o para solicitar e baixar o relat√≥rio em CSV gerado pelo backend.

## üõ†Ô∏è Ferramentas e Tecnologias

O projeto foi constru√≠do utilizando um stack moderno e robusto:

### Backend (`server/`)
- **Framework:** [NestJS](https://nestjs.com/) com adaptador [Fastify](https://www.fastify.io/)
- **Linguagem:** [TypeScript](https://www.typescriptlang.org/)
- **ORM:** [Drizzle ORM](https://orm.drizzle.team/)
- **Base de Dados:** [PostgreSQL](https://www.postgresql.org/)
- **Valida√ß√£o:** [Zod](https://zod.dev/)
- **Containeriza√ß√£o:** [Docker](https://www.docker.com/) e Docker Compose
- **Testes:** [Jest](https://jestjs.io/) e [Supertest](https://github.com/ladjs/supertest)

### Frontend (`web/`)
- **Biblioteca:** [React](https://react.dev/)
- **Bundler:** [Vite](https://vitejs.dev/)
- **Linguagem:** [TypeScript](https://www.typescriptlang.org/)
- **Estiliza√ß√£o:** [Tailwind CSS v4](https://tailwindcss.com/)
- **Componentes:** [shadcn/ui](https://ui.shadcn.com/)
- **Gest√£o de Estado de Servidor:** [TanStack Query (React Query)](https://tanstack.com/query/latest)
- **Gest√£o de Formul√°rios:** [React Hook Form](https://react-hook-form.com/)
- **Cliente HTTP:** [Axios](https://axios-http.com/)

## üöÄ Como Executar o Projeto

Siga os passos abaixo para configurar e executar a aplica√ß√£o localmente.

### Pr√©-requisitos
- [Node.js](https://nodejs.org/) (vers√£o 20.x ou superior)
- [NPM](https://www.npmjs.com/) (geralmente instalado com o Node.js)
- [Docker](https://www.docker.com/products/docker-desktop/) e Docker Compose

### 1. Clonar o Reposit√≥rio
```bash
git clone https://github.com/mauricioyansen/ftr-brev.ly.git
cd ftr-brev.ly
```

### 2. Configura√ß√£o do Backend (`server/`)

**a. Aceda a pasta e instale as depend√™ncias:**
```bash
cd server
npm install
```

**b. Configure as Vari√°veis de Ambiente:**
Crie uma c√≥pia do ficheiro `.env.example` e renomeie-a para `.env`. Preencha as vari√°veis com as suas credenciais.
```bash
cp .env.example .env
```
Crie tamb√©m uma c√≥pia para o ambiente de testes.
```bash
cp .env.example .env.test
```
*Lembre-se de ajustar a `DATABASE_URL` no `.env.test` para apontar para o banco de dados de teste (porta `5434`).*

**c. Suba os Contentores Docker:**
Este comando ir√° iniciar os bancos de dados de desenvolvimento e de teste.
```bash
docker-compose up -d
```

**d. Execute as Migra√ß√µes:**
Este comando ir√° criar as tabelas no seu banco de dados de desenvolvimento.
```bash
npm run db:migrate
```

**e. Execute a Aplica√ß√£o Backend:**
```bash
npm run start:dev
```
O servidor backend estar√° a correr em `http://localhost:3333`.

### 3. Configura√ß√£o do Frontend (`web/`)

**a. Aceda a pasta (num novo terminal) e instale as depend√™ncias:**
```bash
# A partir da raiz do projeto
cd web
npm install
```

**b. Configure as Vari√°veis de Ambiente:**
Crie uma c√≥pia do ficheiro `.env.example` e renomeie-a para `.env.local`.
```bash
cp .env.example .env.local
```
*Os valores padr√£o (`http://localhost:5173` e `http://localhost:3333`) devem funcionar para o ambiente de desenvolvimento local.*

**c. Execute a Aplica√ß√£o Frontend:**
```bash
npm run dev
```
A aplica√ß√£o frontend estar√° acess√≠vel em `http://localhost:5173`.

### 4. Rodando os Testes (Backend)
Para executar os testes, certifique-se de que os contentores Docker est√£o a correr.

**a. Testes Unit√°rios:**
```bash
# Dentro da pasta server/
npm test
```

**b. Testes End-to-End:**
Este comando ir√° preparar automaticamente a base de dados de teste e executar os testes.
```bash
# Dentro da pasta server/
npm run test:e2e
```

## üîó Endpoints da API

A API exp√µe os seguintes endpoints de gest√£o na rota `/links`:

- `POST /links`: Cria um novo link.
- `GET /links`: Lista os √∫ltimos 100 links criados.
- `DELETE /links/:id`: Deleta um link espec√≠fico.
- `GET /links/code/:code`: Busca os dados de um link pelo seu c√≥digo (usado pelo frontend para o redirecionamento).
- `POST /links/export`: Inicia a exporta√ß√£o de todos os links para um ficheiro CSV.

A rota p√∫blica de redirecionamento √©:
- `GET /:code`: Redireciona para a URL original.